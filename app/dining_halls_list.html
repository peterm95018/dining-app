<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>UCSC Dining Services</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
        <!-- build:css(.tmp) styles/main.css -->
   		<link rel="stylesheet" href="bower_components/sass-bootstrap/dist/css/bootstrap.min.css">
        <link rel="stylesheet" href="styles/main.css">
        <link rel="stylesheet" href="styles/customMain.css">
        <!-- endbuild -->

                 <!-- keep some css files out of concatenation build:css process -->
        <link rel="stylesheet" href="bower_components/components-font-awesome/css/font-awesome.css">
        <!-- end -->

        <!-- build:js scripts/vendor/modernizr.js -->
        <script src="bower_components/modernizr/modernizr.js"></script>
        <!-- endbuild -->
		  <script src="bower_components/momentjs/moment.js"></script>
    </head>
    <body>
        <!--[if lt IE 10]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
        
        <!-- override collapsing to turn off animation-->
        <style>
        .collapsing {
			-webkit-transition: none;
			transition: none;
		}
        </style>


		<nav class="navbar navbar-fixed-top navbar-inverse" role="navigation">
          <div class="navbar-custom">
            
            <!-- Below is the logo and brand. In order for them to format correctly, they have to remain outside the container div-->
            <a class="navbar-logo pull-left" href="index.html"><img src="images/nav_logo.png"></a> 

          <div class="container">
            <div class="navbar-header"> 
                  <button type="button" class="btn-custom navbar-toggle pull-right" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

                                    
             </div><!-- /.navbar-header -->
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse navbar-ex1-collapse">
                 <ul class="nav navbar-nav">
                    <li><a href="feedback.html">Feedback</a></li>
                <li><a href="#dininghome">Dining Home</a></li>
                <li><a href="#webportal">Web Portal</a></li>
              </ul>
            </div><!-- /.navbar-collapse -->
          </div><!-- /.container -->
          </div><!-- /.navbar-custom -->
          </nav>
		
	    <div class="container">

	      <div class="row">
	        <div class="col-lg-12">
	          <h1 class="page-header">Dining Halls<small></small></h1>
	        </div>
	      </div>		  
	<!--	  ////// DINING HALLS /////// -->

            <!--  ////// COLLEGE EIGHT/OAKES ////// -->
            <div class="row">
        
	        <div class="col-lg-7 col-md-7">
	          <a href="#"><img class="img-responsive" src="images/college-eight-oakes-dining-hall.jpg" alt="college eight oakes dining hall"></a>
	        </div>

	        <div class="col-lg-5 col-md-5">
	          <h3>College Eight&#47;Oakes</h3>
	          <h4>Dining Hall</h4>
	          <p>With an incredible view of the bay and hillsides of Santa Cruz, this place is as inviting as it gets. This is the home of our campus bakeshop, which produces our entire array of cookies, breads, brownies, and more. If you are looking for late night dining options on the west side of campus, College Eight/Oakes has what you’re craving.</p>
			  <div id="" class="btn-group-md">
		          <a class="btn btn-primary" href="map.html?zoom=17&lat=36.99164&lng=-122.06534&title=College Eight&#47;Oakes" data-locationName="College Eight&#47;Oakes">Map <span class="glyphicon glyphicon-map-marker"></span></a>
				  <a class="btn btn-info" role="dialog" href="#" data-toggle="modal" data-target="#myModalMenu" data-locationName="College Eight&#47;Oakes">Menu <span class="glyphicon glyphicon-chevron-right"></span></a>				   
				  <a class="btn btn-success" role="dialog" href="#" data-toggle="modal" data-target="#myModalInfo" data-locationName="College Eight&#47;Oakes">Hours <span class="glyphicon glyphicon-time"></span></a>
			  </div>
	        </div>
	      </div>
	      <hr>

            <!--  ////// COLLEGE NINE/TEN ////// -->
            <div class="row">
        
	        <div class="col-lg-7 col-md-7">
	          <a href="#"><img class="img-responsive" src="images/colleges-nine-and-ten-dining-hall.jpg" alt="colleges nine and ten dining hall"></a>
	        </div>

	        <div class="col-lg-5 col-md-5">
	          <h3>Colleges Nine&#47;Ten</h3>
	          <h4>Dining Hall</h4>
	          <p>This exhibition-style food court, showcasing the latest dining trends, encourages students to roam from station to station making selections. Widely recognized by students, faculty and staff for its vegan entrée options, this dining commons also has an adjacent multi-purpose room which offers additional seating and community events.</p>
			  <div id="" class="btn-group-md">
		          <a class="btn btn-primary" href="map.html?zoom=17&lat=37.00074&lng=-122.05786&title=Colleges Nine&#47;Ten" data-locationName="Colleges Nine&#47;Ten">Map <span class="glyphicon glyphicon-map-marker"></span></a>
				  <a class="btn btn-info" role="dialog" href="#" data-toggle="modal" data-target="#myModalMenu" data-locationName="Colleges Nine&#47;Ten">Menu <span class="glyphicon glyphicon-chevron-right"></span></a>				   
				  <a class="btn btn-success" role="dialog" href="#" data-toggle="modal" data-target="#myModalInfo" data-locationName="Colleges Nine&#47;Ten">Hours <span class="glyphicon glyphicon-time"></span></span></a>
			  </div>
	        </div>
	      </div>
	      <hr>

              <!-- ////// COWELL/STEVENSON ////// -->
	      <div class="row">
	        <div class="col-lg-7 col-md-7">
	          <a href="#"><img class="img-responsive" src="images/cowell-stevenson-dining-hall.jpg" alt="cowell stevenson dining hall"></a>
	        </div>

	        <div class="col-lg-5 col-md-5">
	          <h3>Cowell&#47;Stevenson</h3>
	          <h4>Dining Hall</h4>
	          <p>Featuring the international flavors of a Mongolian-style grill, freshly prepared sushi, and delicious fire-baked pizzas, this dining hall has comfy sofa seating and an outdoor patio overlooking the Monterey Bay.</p>
			  <div id="" class="btn-group-md">
		          <a class="btn btn-primary" href="map.html?zoom=17&lat=36.99688&lng=-122.05302&title=Cowell&#47;Stevenson" data-locationName="Cowell&#47;Stevenson">Map <span class="glyphicon glyphicon-map-marker"></span></a>
				  <a class="btn btn-info" role="dialog" href="#" data-toggle="modal" data-target="#myModalMenu" data-locationName="Cowell&#47;Stevenson">Menu <span class="glyphicon glyphicon-chevron-right"></span></a>				   
				  <a class="btn btn-success" role="dialog" href="#" data-toggle="modal" data-target="#myModalInfo" data-locationName="Cowell&#47;Stevenson">Hours <span class="glyphicon glyphicon-time"></span></span></a>
			  </div>
	        </div>
	      </div>
	      <hr>
		  
              <!--  ////// CROWN/MERILL ////// -->
	      <div class="row">
        
	        <div class="col-lg-7 col-md-7">
	          <a href="#"><img class="img-responsive" src="images/crown-merrill-dining-hall.jpg" alt="crown merrill dining hall"></a>
	        </div>

	        <div class="col-lg-5 col-md-5">
	          <h3>Crown&#47;Merrill</h3>
	          <h4>Dining Hall</h4>
	          <p>A lively venue offering organic salad bar, daily speciality bar and our new gluten free station. This bright, colorful dining hall is buzzing with activity throughout the day. Students make it a point to meet at Crown/Merrill when they are “up on the hill”.</p>
			  <div id="" class="btn-group-md">
		          <a class="btn btn-primary" href="map.html?zoom=17&lat=37.00015&lng=-122.05441&title=Crown&#47;Merrill" data-locationName="Crown&#47;Merrill">Map <span class="glyphicon glyphicon-map-marker"></span></a>
				  <a class="btn btn-info" role="dialog" href="#" data-toggle="modal" data-target="#myModalMenu" data-locationName="Crown&#47;Merrill">Menu <span class="glyphicon glyphicon-chevron-right"></span></a>				   
				  <a class="btn btn-success" role="dialog" href="#" data-toggle="modal" data-target="#myModalInfo" data-locationName="Crown&#47;Merrill">Hours <span class="glyphicon glyphicon-time"></span></span></a>
			  </div>
	        </div>
	      </div>
	      <hr>
		  
	      <!--  ////// PORTER/KRESGE ////// -->
	      <div class="row">
        
	        <div class="col-lg-7 col-md-7">
	          <a href="#"><img class="img-responsive" src="images/porter-kresge-dining-hall.jpg" alt="porter kresge dining hall"></a>
	        </div>

	        <div class="col-lg-5 col-md-5">
	          <h3>Porter&#47;Kresge</h3>
	          <h4>Dining Hall</h4>
	          <p>Located on the west side of campus, the Porter/Kresge Dining Hall has been redesigned and expanded. The servery offers chef-customized traditional style entrees, signature salads, and pizzas.</p>
			  <div id="" class="btn-group-md">
		          <a class="btn btn-primary" href="map.html?zoom=17&lat=36.99419&lng=-122.06585&title=Porter&#47;Kresge" data-locationName="Porter&#47;Kresge">Map <span class="glyphicon glyphicon-map-marker"></span></a>
				  <a class="btn btn-info" role="dialog" href="#" data-toggle="modal" data-target="#myModalMenu" data-locationName="Porter&#47;Kresge">Menu <span class="glyphicon glyphicon-chevron-right"></span></a>				   
				  <a class="btn btn-success" role="dialog" href="#" data-toggle="modal" data-target="#myModalInfo" data-locationName="Porter&#47;Kresge">Hours <span class="glyphicon glyphicon-time"></span></span></a>
			  </div>
	        </div>
	      </div>
	      <hr>
		  

		  <!-- ////// END DINING HALLS -->


	<footer>
	   <div class="row">
	      <div class="col-lg-12">
	        <!--<p>&copy; 2014 Regents of the University of California \n About &middot; Feedback &middot; Facebook &middot; Twitter &middot; instagram</p> -->
			<p class="text-centered"><span class="small">&copy; 2014 Regents of the University of California </span>
			&nbsp;
			<a href="https://www.facebook.com/UcscDining"><i class="fa fa-facebook"></i></a>  
			&middot; <a href="https://twitter.com/UCSCDining"><i class="fa fa-twitter"></i></a>
			&middot; <a href="http://instagram.com/ucscdining"><i class="fa fa-instagram"></i> </a>
			</p>
	       </div>
	    </div>
	 </footer>

</div> <!-- ./container -->	

		  
		  <!-- ////// MODAL DIALOGS ////// -->
		  
		  <!-- Hours Info Modal -->
		  <div class="modal fade" id="myModalInfo" tabindex="-1" role="dialog" aria-labelledby="myModalLabelInfo" aria-hidden="true">
		    <div class="modal-dialog">
		      <div class="modal-content">
		        <div class="modal-header">
		          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		          <h4 class="modal-title" id="myModalLabelInfo">Hours </h4>
		        </div>
		        <div id="modal-body-info" class="modal-body">
			
		        </div>
		        <div class="modal-footer">
		          <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
		        </div>
		      </div><!-- /.modal-content -->
		    </div><!-- /.modal-dialog -->
		  </div><!-- /.modal -->
		  
		  
		  <!-- Menu Modal -->
		  <div class="modal fade" id="myModalMenu" tabindex="-1" role="dialog" aria-labelledby="myModalLabelMenu" aria-hidden="true">
		    <div class="modal-dialog">
		      <div class="modal-content">
		        <!--<div class="modal-header">
		          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		          <h4 class="modal-title" id="myModalLabelMenu">Menu  </h4>
		        </div>-->
		        <div id="modal-body-menu" class="modal-body">
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
					<!-- Nav tabs -->
					<ul id="myTabs" class="nav nav-tabs" role="tablist">
					  <li class="active" id="breakfastTab"><a style="outline:0" href="#breakfast" role="tab" data-toggle="tab">Breakfast</a></li>
					  <li id="lunchTab"><a style="outline:0" href="#lunch" role="tab" data-toggle="tab">Lunch</a></li>
					  <li id="dinnerTab"><a style="outline:0" href="#dinner" role="tab" data-toggle="tab">Dinner</a></li> 
					</ul>
					
					<!--Tabbed content-->
					<div class="tab-content">
					  <div class="tab-pane active" style="padding-top:10px;" id="breakfast"></div>
					  <div class="tab-pane" style="padding-top:10px;" id="lunch"></div>
					  <div class="tab-pane" style="padding-top:10px;" id="dinner"></div>
					</div>
		        </div>
		        <div class="modal-footer" style="margin-top:0px;">
		          <button type="button"  class="btn btn-primary" data-dismiss="modal">Close</button>
		        </div>
		      </div><!-- /.modal-content -->
		    </div><!-- /.modal-dialog -->
		  </div><!-- /.modal -->



        <!-- build:js scripts/vendor.js -->
        <!-- bower:js -->
        <script src="bower_components/jquery/jquery.js"></script>
		<script src="bower_components/sass-bootstrap/dist/js/bootstrap.min.js"></script>
		<script src="bower_components/jquery-touchswipe/jquery.touchSwipe.js"></script>
        <!-- endbower -->
        <!-- endbuild -->
		
		<script>
		$('.btn').click(function(e) {
			//e.preventDefault();
		   var locationName = $(this).attr('data-locationName');
		   var tempBtnType = $(this).attr('data-target'); // returns #myModalInfo or #myModalMenu
		   var btnType = tempBtnType.substring(1); // strip off the #
		   console.log(btnType);
		   console.log(locationName);
   
		   if (btnType === 'myModalInfo') {
			   myModalInfo(locationName);
		   }
   
		   if (btnType === 'myModalMenu') {
			   myModalMenu(locationName);
		   }
		   
		   if (btnType === 'map') {
			   
		   }

		});

		///// function def's //////

		function getAndroidVersion(ua){//Stolen straight from http://stackoverflow.com/q/7184573
			var ua = ua || navigator.userAgent; 
			var match = ua.match(/Android\s([0-9\.]*)/);
			return match ? match[1] : false;
		}

		function myModalInfo(locationName) {
			$.getJSON("data/whats-open-hours.json", function(data) {
				var items = '';
				var tempLocationName = '';
				var ourTableHead = '<table class=\'table table-striped\'><tr><th>Day</th><th>Open</th><th>Close</th></tr>';
				var ourTableTail = '</table>';
				
				var ourData = data.DiningHalls;
			
			switch(locationName){
				case "College Eight/Oakes":
					ourData = ourData.CollegeEightOakes;
					break;
				case "Colleges Nine/Ten":
					ourData = ourData.CollegesNineTen;
					break;
				case "Cowell/Stevenson":
					ourData = ourData.CowellStevenson;
					break;
				case "Crown/Merrill":
					ourData = ourData.CrownMerrill;
					break;
				case "Porter/Kresge":
					ourData = ourData.PorterKresge;
					break;
			}
				console.log(ourData);
				items += ourTableHead;
				//Monday
				if(ourData.Monday.Open !== ""){
					items += "<tr> <td>Monday</td><td>" + moment(ourData.Monday.Open, "h:mm").format("h:mm a") + "</td><td>" + moment(ourData.Monday.Close, "h:mm").format("h:mm a") + "</td></tr>";
				}
				//Tuesday
				if(ourData.Tuesday.Open !== ""){
					items += "<tr> <td>Tuesday</td><td>" + moment(ourData.Tuesday.Open, "h:mm").format("h:mm a") + "</td><td>" + moment(ourData.Tuesday.Close, "h:mm").format("h:mm a") + "</td></tr>";
				}
				//Wednesday
				if(ourData.Wednesday.Open !== ""){
					items += "<tr> <td>Wednesday</td><td>" + moment(ourData.Wednesday.Open, "h:mm").format("h:mm a") + "</td><td>" + moment(ourData.Wednesday.Close, "h:mm").format("h:mm a") + "</td></tr>";
				}
				//Thursday
				if(ourData.Thursday.Open !== ""){
					items += "<tr> <td>Thursday</td><td>" + moment(ourData.Thursday.Open, "h:mm").format("h:mm a") + "</td><td>" + moment(ourData.Thursday.Close, "h:mm").format("h:mm a") + "</td></tr>";
				}
				//Friday
				if(ourData.Friday.Open !== ""){
					items += "<tr> <td>Friday</td><td>" + moment(ourData.Friday.Open, "h:mm").format("h:mm a") + "</td><td>" + moment(ourData.Friday.Close, "h:mm").format("h:mm a") + "</td></tr>";
				}
				//Saturday
				if(ourData.Saturday.Open !== ""){
					items += "<tr> <td>Saturday</td><td>" + moment(ourData.Saturday.Open, "h:mm").format("h:mm a") + "</td><td>" + moment(ourData.Saturday.Close, "h:mm").format("h:mm a") + "</td></tr>";
				}
				//Sunday
				if(ourData.Sunday.Open !== ""){
					items += "<tr> <td>Sunday</td><td>" + moment(ourData.Sunday.Open, "h:mm").format("h:mm a") + "</td><td>" + moment(ourData.Sunday.Close, "h:mm").format("h:mm a") + "</td></tr>";
				}
				
			    // close the table
			    items += ourTableTail;
			   
			    // we use the empty() to make sure we don't get duplicate data
			    $('#modal-body-info').empty().append(items);
			    $('#myModalLabelInfo.modal-title').empty().append(locationName);
			   
				});
		}
		
		function myModalMenu(locationName) {

			//We have to empty the previous info
			$("#breakfast").empty();
			$("#lunch").empty();
			$("#dinner").empty();
			
			//We want to get the right bundle of data before anything else,
			//The below function is a placeholder until we can successfully 
			//call the php function
			
			location_num = "";
			switch(locationName){
				case "College Eight/Oakes":
					location_num = "30";
					break;
				case "Colleges Nine/Ten":
					location_num = "40";
					break;
				case "Cowell/Stevenson":
					location_num = "05";
					break;
				//We don't know what this number is, just return until we can find that data
				case "Crown/Merrill":
					return;
					break;
				case "Porter/Kresge":
					location_num = "25";
					break;
			}
			
			// XMLHttpRequest lets us send variables in the URL to the PHP
			var xhr = new XMLHttpRequest();
			xhr.open('POST', 'menu.php', true);
			xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');//Supports old browsers
			xhr.onload = function () { //Listener that waits for XmlHttp request, then it gets JSON from php once loaded
				var jsonObj = $.parseJSON(this.responseText);// The JSON grabbed from the php
				onPHPLoad(jsonObj);//Do the parsing and placing of the JSON here.
			};

			var today = moment().format("MM/DD/YYYY"); //Eg: 07/24/2014
			xhr.send('serve_date=' +today+ '&location_num=' + location_num);//Send the data over the URL
			
			//This is a big function that parses the JSON holding the menu items.
			//It's only called from the xhr.onload listener. It puts items in the 3 menu modal tabs.
			//It also checks if you're using an old android and will do plaintext if so.
			function onPHPLoad(jsonData){			

				//This part creates the outer collapse accordion div
				//We append stuff to it in the for loop
				$("#breakfast").append('<div class="panel-group" id="breakfastaccordion"></div>');
				$("#lunch").append('<div class="panel-group" id="lunchaccordion"></div>');
				$("#dinner").append('<div class="panel-group" id="dinneraccordion"></div>');

				var androidversion = parseInt(getAndroidVersion());
				//Now we can start appending the javascript data from myData into the right tabs
				for(var j = 0; j < jsonData.length; j++){
					var row = jsonData[j];
					//One more sort to determine which meal goes where
					var time = "";
					switch(row.Meal_Number){
						case "1": time = "breakfast";
								   break;
						case "2": time = "lunch";
								   break;
						case "3": time = "dinner";
								   break;
					}
					var menu_item = "";
					
					if(androidversion < 3){//Use plain text if it's an older Android. No accordion.
						menu_item  = "<p style='font-size:14px;padding-left:7px;'>";
						menu_item = menu_item + "&middot;"+ row.Recipe_Print_As_Name;
						menu_item = menu_item + "</p>";
					}
					//Create a blank collapsable element (lots of divs)
					else{
						menu_item = '<div class="panel panel-default">' +
								'<div class="panel-heading">' +
									'<p class="panel-title">' +
										'<a data-toggle="collapse" data-parent="#'+time+'accordion" href="#collapse' + j + '">' +
											row.Recipe_Print_As_Name + //Item title
										'</a>' +
									'</p>' +
								'</div>' +
								'<div id="collapse' +j+ '" class="panel-collapse collapse">' +
									'<div class="panel-body">' + //This is where the content gets appended
									'</div>' +
								'</div>' +
							'</div>';
					}
					//Push the items into the appropriate accordion
					//Eg: $("#breakfastaccordion").append(menu_item); Adds item to breakfast menu.
					$("#"+time+"accordion").append(menu_item);

					//Check if allergens/codes are blank, print only if non-blank.
					if( row.Allergens.trim() ){$("#"+time+" .panel-body:last").append("Allergens: "+ row.Allergens.trim()+"<br>");}
					if( row.Recipe_Web_Codes.trim() ){$("#"+time+" .panel-body:last").append(row.Recipe_Web_Codes.trim());}

				}//End FOR loop		
				
				var currentTime = (new Date()).getHours();
				$("#breakfastTab").removeClass("active");
				$("#lunchTab").removeClass("active");
				$("#dinnerTab").removeClass("active");
				$("#breakfast").removeClass("active");
				$("#lunch").removeClass("active");
				$("#dinner").removeClass("active");
				
				if(currentTime < 11){
					$("#breakfastTab").addClass("active");
					$("#breakfast").addClass("active");
					$("#breakfastTab a").tab('show');
				}
				if(currentTime > 10 && currentTime < 17){
					$("#lunchTab").addClass("active");
					$("#lunch").addClass("active");
					$("#lunchTab a").tab('show');
				}
				if(currentTime > 16){
					$("#dinnerTab").addClass("active");
					$("#dinner").addClass("active");
					$("#dinnerTab a").tab('show');
				}
			
			}
		}//End function
	
		</script>


        <!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
        <script>
            (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
            function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
            e=o.createElement(i);r=o.getElementsByTagName(i)[0];
            e.src='//www.google-analytics.com/analytics.js';
            r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
            ga('create','UA-XXXXX-X');ga('send','pageview');
        </script>

        <!-- build:js scripts/main.js -->
        <script data-main="scripts/main" src="bower_components/requirejs/require.js"></script>
        <!-- endbuild -->
</body>
</html>
